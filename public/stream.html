
<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Datafish Stream</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">

    <!-- Add custom CSS here -->
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400' rel='stylesheet' type='text/css'>
    <link href="/css/stylish-portfolio.css" rel="stylesheet">
    <!--link href="css/flat-ui.css" rel="stylesheet"-->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="javascripts/sidr/stylesheets/jquery.sidr.light.scss">
  
  <link href="/js/c3-0.4.1/c3.css" rel="stylesheet" type="text/css">

                    <!-- Load d3.js and c3.js -->
                    <script src="/js/d3.min.js" charset="utf-8"></script>
                    <script src="/js/c3-0.4.1/c3.min.js"></script>
                    <!-- JavaScript -->
    <script class="cssdeck" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.14.2/TweenMax.min.js"></script>
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>
    <!-- Custom JavaScript for the Side Menu and Smooth Scrolling -->

    <script src="js/grayscale.js"></script>
    <!-- Include jQuery -->
    <script src="javascripts/jquery.js"></script>
    <!-- Include the Sidr JS -->
    <script src="javascripts/sidr/jquery.sidr.js"></script>
</head>

<body ng-app="userApp" ng-controller="UserCtrl" id="page-top" class="header" data-spy="scroll" data-target=".navbar-custom">

<div id="fb-root"></div>
<!--
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
-->
      <nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                    <i class="fa fa-bars"></i>
                </button>
                <a href="/explore"><img src="img/logo.png"></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="navbar-right collapse navbar-collapse navbar-main-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>

                    <li id="following">
                        <a href="/explore">Explore</a>
                    </li>
                    <li id="following">
                        <a href="/dashboard">Following</a>
                    </li>
                    <li id="favorites">
                        <a href="/mystreams">My Streams</a>
                    </li>
                    <!--li id="search" class="search">
                        

                           <input ng-model="query" id="logEmail" type="text" placeholder="Search" />
                           <span class="input-group-btn">
                                <button type="submit" class="btn"><span class="fui-search"></span></button>
                            </span>    
                        
                    </li--> <!--Search: (outside brackets) input ng-model="query" type="text"/-->
                   
                    <li id="new-datapoint">
                        <a href="#newBubbleModal" data-toggle="modal" data-target="#newBubbleModal">New Databubble</a>
                    </li>
                    <li id="options" >
                        <a href="#">{{users.name}} <i class="fa fa-angle-down"></i></a>
                        <ul class="subnav">
                            <li><a href="/account">Profile</a></li>
                             <li id="new-stream">
                                <a href="#newStreamModal" data-toggle="modal" data-target="#newStreamModal">New Stream</a>
                            </li>
                            <li><a href="/logout">Logout</a></li>
                        </ul>
                    </li>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>



    <div id="top" class="dash container">
       <div class="stream">

            <div class="stream-info">
                

                <div class="row col-md-2 col-xs-2 card-genre">
                      <a href="#about">
                          <img align="left" src="/img/Health.png"> <!-- Edit this for specific genre -->
                      </a>
                      
                  </div>
                  <div class="row col-md-offset-1 col-md-7 col-xs-offset-1 col-xs-7 card-title">
                      <h1 id="name"></h1>
                      <!--a ng-href="/streamPage?id={{stream}}"></a--> <!-- Edit this for specific title -->
                  </div>
                  <div class=" col-md-1 col-xs-offset-1 col-xs-1  col-xs-offset-1 card-follow">
                      <a href="#about">
                          <img align="right" src="img/PlusSign.png"> <!-- Edit this if not a plus sign -->
                      </a>
                      
                  </div>


                <!--div class="row col-md-offset-1 col-md-3 card-genre">icon</div>
                <div id="description" class="row col-md-5 description"></div>
                <div class="row col-md-offset-1 col-md-2 card-follow">Follow</div-->
            </div>

            <div class="stream-graph">
            <div class="row">
            </div>
                <div class="row col-md-4 card-unit"></div>
                <div class="row col-md-8 card-value">
                    <div id="chart"></div>
                    <!-- Load c3.css -->


                </div>
            </div>
            <div class="stream-footer">
                <div class="col-md-offset-1 row col-md-5 card-date">11-16-14</div>
                <div class="col-md-offset-1 row col-md-5 card-star">Favorite</div>
            </div>
        </div>
    </div>



    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.1/angular.min.js"></script>
    <script>
      var app = angular.module('userApp', []);
      
      app.controller('UserCtrl', function($scope, $http){
        
        $http.get('/user').success(function(data) {
          $scope.users = data;
          console.log($scope.users);
          
          $scope.owner = $scope.users.owner;

          /*for (var j = 0; j < $scope.users.owner.length; j ++) {
            $scope.following.push($scope.users.owner[j]);
          }*/


          console.log($scope.owner)
          $scope.ownerObjs = [];
          
          for (i = 0; i < $scope.owner.length; i++) {
            $http.get('/stream?id=' + $scope.owner[i]).success((function(i){return function(data) {
                if (data != '') {
                    $scope.ownerObjs.push(data);
                      console.log('Owner Objs:')
                      console.log($scope.owner[i])
                      console.log(data)
                      console.log($scope.ownerObjs)
//                      console.log(data.latestValue)
                  }
            }; })(i))
          }

            $http.get('/hack/allStreams').success(function(data) {
                $scope.all = data;
                console.log($scope.all);
                for (i = 0; i < $scope.all.length; i++) {
                    console.log($scope.all[i]);
                    //(function(i){return function(data) {}; })(i)
                    
                    $scope.bubbles = {};
                    $http.get('/stream?id=' + $scope.all[i]._id).success((function(i){return function(data) {
                        var streamid = $scope.all[i]._id;
                        console.log(data)
                        $scope.bubbles[streamid] = data;
                        latest = 0;
                        if (data.latestValue != null) {
                            latest = data.latestValue;
                        }
                        $scope.bubbles[streamid].recent = latest;
                        console.log(data.latestValue);

                        if ($scope.bubbles[streamid].genre == 'health') {
                            $scope.bubbles[streamid].genreSrc = "/img/Health.png";
                        
                        } else if ($scope.bubbles[streamid].genre == 'finance') {
                            $scope.bubbles[streamid].genreSrc = "/img/Finance.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'environment') {
                            $scope.bubbles[streamid].genreSrc = "/img/Environment.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'politics') {
                            $scope.bubbles[streamid].genreSrc = "/img/Politics.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'sports') {
                            $scope.bubbles[streamid].genreSrc = "/img/Sports.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'tv') {
                            $scope.bubbles[streamid].genreSrc = "/img/TV.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'energy') {
                            $scope.bubbles[streamid].genreSrc = "/img/Energy.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'education') {
                            $scope.bubbles[streamid].genreSrc = "/img/Education.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'business') {
                            $scope.bubbles[streamid].genreSrc = "/img/Business.png";
                            
                        } else if ($scope.bubbles[streamid].genre == 'inequality') {
                            $scope.bubbles[streamid].genreSrc = "/img/Inequality.png";
                           
                        }

                   }; })(i));
                }
            });
          console.log($scope.bubbles)
        });
      });
    </script>
     <script>
                        $(document).ready(function(){
                            function getParameterByName(name) {
                                name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                                var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                                    results = regex.exec(location.search);
                                return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
                            }
                        

                            
                            console.log(getParameterByName('id'))
                            var description = getParameterByName('description')
                            var picture = getParameterByName('picture')
                            var points = getParameterByName('points')
                            console.log("description is" + description)
                            console.log("picture is" + picture)
                            console.log("points is" + points)
                            console.log(getParameterByName('name'))



                            var test = ({"name":"People with Ebola in US","genre":"health","tags":[],"_id":"546853c0f48b87e385ddf7fd","points":[{"time":"12am","stream_id":"546853c0f48b87e385ddf7fd","source":"cdc","creator":"54681fb90d0903a9637f25f7","_id":"546853d8f48b87e385ddf7fe","__v":0},{"time":"1pm","stream_id":"546853c0f48b87e385ddf7fd","source":"cdc","creator":"54681fb90d0903a9637f25f7","_id":"546853ddf48b87e385ddf7ff","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685d6a1850c35095f03ecc","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685d6d1850c35095f03ecd","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685d821850c35095f03ece","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685ddb1850c35095f03ecf","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685e0d97f41bf0955bf5f3","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685e5397f41bf0955bf5f4","__v":0},{"value":23,"time":"2pm","stream_id":"546853c0f48b87e385ddf7fd","source":"cdc","creator":"54681fb90d0903a9637f25f7","_id":"54685e5a97f41bf0955bf5f5","__v":0},{"value":24,"time":"2pm","stream_id":"546853c0f48b87e385ddf7fd","source":"cdc","creator":"54681fb90d0903a9637f25f7","_id":"54685e8697f41bf0955bf5f6","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685f821c3bdf7b97279997","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685f8c1c3bdf7b97279998","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685fafd5c115b097324eb1","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54685fb7d5c115b097324eb2","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"546860ba990d28ba98d003dc","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"546860c3990d28ba98d003dd","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686196351383ca99dfe917","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"546861a3351383ca99dfe918","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686521351383ca99dfe919","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686543351383ca99dfe91a","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686560351383ca99dfe91b","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"5468657d351383ca99dfe91c","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686582351383ca99dfe91d","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"546865f6351383ca99dfe91e","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686622351383ca99dfe91f","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686628351383ca99dfe920","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54686d38648fe978a57fcb22","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"5468732599b241c4d77efa0e","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"546877dba26ec12db019ac32","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"5468794699b241c4d77efa0f","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54687ba8933fd045b4d2c870","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"54689dbc9e1a4a00008d2f29","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"5468a6649e1a4a00008d2f2c","__v":0},{"value":20,"time":"100000","stream_id":"546853c0f48b87e385ddf7fd","source":"Me","_id":"5468a9509e1a4a00008d2f2d","__v":0}]})
                            console.log(test)

                            console.log("Name is " + test.name)

                            /*
                            $.each(test.points, function (index, point) {
                                $('#myElement').data('key',jsonObject);
                            }  */
                            //$('#myElement').data('key',jsonObject);
                            $('#name').text(test.name);
                            $('#genre').text(test.genre);
                            $('#tags').text(test.tags);
                            $('#description').text(test.description);
                            $('#source').text(test.source);                            
                            $('#data').text(test.points);
                            console.log(test.points);

                             //bindto: '#chart',

                            
                             var values = [];
                             var times = [];
                             $.each(test.points, function(index, point) {
                                values.push(point.value);
                                times.push(point.time);
                             });
                             console.log(values)
                             console.log(times)
                             if (values.length >0) {
                                values.splice(0,2);
                                times.splice(0,2);
                             }
                             console.log(values)
                             console.log(times)

                            var chart = c3.generate({
                                data: {
        xs: {
            'Ebola Cases': 'month',
        },
        columns: [
            ['month', 6, 7, 8, 9, 10, 11],
            //['x2', 30, 50, 75, 100, 120],
            ['Ebola Cases', 0, 0, 2, 4, 1, 0],
            //['data2', 20, 180, 240, 100, 190]
        ]
    }
                                
                            });
                    
                        
                            
                            var test = $.get('http://datafish.nodejitsu.com/stream?id=' + getParameterByName('id'), function(data) {
                                console.log(data);

                            })

                            console.log(test)
                            
                        });
                            </script>
                            

   
    
    
    
</body>

</html>